{"task": "documents_with_infrequent_words", "language": "sql", "plan": {}, "source": "-- NOTE: SQLite tokenize is case-insensitive by default, \n-- so this solution is NOT exactly like the others\n\nCREATE VIRTUAL TABLE doc_index USING fts4(\n  text, id, content=documents, tokenize=simple);    \nINSERT INTO doc_index(doc_index) VALUES('rebuild');\nCREATE VIRTUAL TABLE words USING fts4aux(doc_index);    \n\nSELECT DISTINCT id\nFROM \n  documents\n  CROSS JOIN\n  (SELECT DISTINCT term\n   FROM words\n   WHERE occurrences = 1) unique_words\nWHERE\n  (LOWER(text) LIKE '% ' || term || ' %') OR\n  (LOWER(text) LIKE term || ' %') OR\n  (LOWER(text) LIKE '% ' || term) OR\n  (LOWER(text) LIKE term)", "author": "will", "implementation": ""}