{"task": "documents_with_infrequent_words", "language": "python-functional", "plan": {"word": [{"line": 1, "start": 2, "end": 55}], "frequency": [{"line": 2, "start": 2, "end": 46}, {"line": 3, "start": 2, "end": 10}, {"line": 4, "start": 4, "end": 33}, {"line": 5, "start": 4, "end": 31}, {"line": 6, "start": 2, "end": 3}, {"line": 7, "start": 2, "end": 26}, {"line": 8, "start": 4, "end": 41}, {"line": 9, "start": 4, "end": 17}, {"line": 10, "start": 2, "end": 4}], "documents": [{"line": 11, "start": 2, "end": 21}, {"line": 12, "start": 4, "end": 53}, {"line": 13, "start": 4, "end": 42}, {"line": 14, "start": 2, "end": 3}, {"line": 15, "start": 2, "end": 24}]}, "source": "def documents_with_infrequent_words(documents):\n  words = [doc[\"text\"].split(\" \") for doc in documents]\n  words_flat = [w for ws in words for w in ws]\n  freq = {\n    word: words_flat.count(word) \n    for word in set(words_flat)\n  }\n  infrequent_words = set([\n    word for word, count in freq.items() \n    if count == 1\n  ])\n  infrequent_docs = [\n    documents[i][\"id\"] for i, ws in enumerate(words) \n    if len(set(ws) & infrequent_words) > 0\n  ]\n  return infrequent_docs", "author": "will", "implementation": ""}