{"task": "time_series", "language": "datalog", "plan": {}, "source": "\n.decl window(w: number)\n.decl windowed(w: number, x: float)\n.decl windowed_total(w: number, x: float)\nwindow(t/7) :- data(t, _).\nwindowed(t/7, x) :- data(t, x).\n// division by result of count (has type `number`) didn't work\nwindowed_total(w, total/(n)) :- window(w), total = sum x : { windowed(w, x) },\n                              n = sum z : { windowed(w,x), z=1.0 }.\ntime_series(v) :- windowed_total(_, v).\n", "author": "scott", "implementation": ""}