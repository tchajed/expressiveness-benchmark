{"task": "average_window", "language": "datalog", "plan": {"average": [{"line": 5, "start": 18, "end": 27}, {"line": 6, "start": 2, "end": 37}, {"line": 7, "start": 6, "end": 44}], "group by": [{"line": 0, "start": 0, "end": 23}, {"line": 2, "start": 0, "end": 35}, {"line": 3, "start": 0, "end": 31}, {"line": 4, "start": 0, "end": 41}, {"line": 1, "start": 0, "end": 26}], "key": [{"line": 1, "start": 7, "end": 10}, {"line": 3, "start": 9, "end": 12}, {"line": 1, "start": 7, "end": 10}], "output_order": []}, "source": ".decl window(w: number)\nwindow(t/7) :- data(t, _).\n.decl windowed(w: number, x: float)\nwindowed(t/7, x) :- data(t, x).\n.decl windowed_total(w: number, x: float)\nwindowed_total(w, total / n) :- window(w),\n  total = sum x : { windowed(w, x) },\n      n = sum z : { windowed(w, x), z=1.0 }.\naverage_window(v) :- windowed_total(_, v).", "author": "scott", "implementation": ""}