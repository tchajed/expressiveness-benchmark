{"task": "continent_median_population", "language": "datalog", "plan": {"iter": [{"line": 20, "start": 2, "end": 29}], "name": [{"line": 20, "start": 12, "end": 21}, {"line": 19, "start": 28, "end": 37}], "agg": [{"line": 19, "start": 39, "end": 45}, {"line": 21, "start": 2, "end": 53}, {"line": 22, "start": 2, "end": 27}, {"line": 23, "start": 4, "end": 54}, {"line": 24, "start": 3, "end": 26}, {"line": 25, "start": 4, "end": 47}, {"line": 26, "start": 4, "end": 43}, {"line": 27, "start": 4, "end": 28}, {"line": 0, "start": 0, "end": 46}, {"line": 1, "start": 0, "end": 50}, {"line": 2, "start": 0, "end": 0}, {"line": 3, "start": 0, "end": 56}, {"line": 4, "start": 0, "end": 45}, {"line": 5, "start": 2, "end": 44}, {"line": 6, "start": 2, "end": 25}, {"line": 7, "start": 2, "end": 21}, {"line": 8, "start": 4, "end": 32}, {"line": 9, "start": 4, "end": 22}, {"line": 10, "start": 4, "end": 18}, {"line": 11, "start": 2, "end": 4}, {"line": 12, "start": 2, "end": 18}, {"line": 13, "start": 4, "end": 32}, {"line": 14, "start": 4, "end": 22}, {"line": 15, "start": 4, "end": 20}, {"line": 16, "start": 4, "end": 12}, {"line": 17, "start": 2, "end": 4}], "group": [{"line": 21, "start": 26, "end": 52}, {"line": 8, "start": 14, "end": 23}, {"line": 5, "start": 12, "end": 21}]}, "source": ".decl unique_id(Country:symbol, Id:number)    \nunique_id(Country, $) :- countries(_, Country, _).\n\n.decl rank(Continent:symbol, R:number, Population:float)\nrank(Continent, R_less + R_eq, Population) :-\n  countries(Continent, Country, Population),\n  unique_id(Country, Id),\n  R_less = count : { \n    countries(Continent, C, P), \n    unique_id(C, Id2),\n    P < Population\n  },\n  R_eq = count : {\n    countries(Continent, C, P), \n    unique_id(C, Id2),\n    P = Population, \n    Id2 < Id\n  }.\n\ncontinent_median_population(Continent, Median) :-\n  countries(Continent, _, _),\n  Num_countries = count : countries(Continent, _, _),\n  ((Num_countries % 2 = 1, \n    rank(Continent, (Num_countries - 1) / 2, Median));\n   (Num_countries % 2 = 0,\n    rank(Continent, Num_countries / 2 - 1, P1),\n    rank(Continent, Num_countries / 2, P2),\n    Median = (P1 + P2) / 2)).     ", "author": "will", "implementation": ""}