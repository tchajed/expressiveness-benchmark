{"task": "continent_median_population", "language": "sql", "plan": {"name": [{"line": 0, "start": 7, "end": 16}], "agg": [{"line": 0, "start": 18, "end": 47}, {"line": 2, "start": 2, "end": 13}, {"line": 3, "start": 4, "end": 21}, {"line": 4, "start": 30, "end": 59}, {"line": 5, "start": 4, "end": 16}, {"line": 6, "start": 31, "end": 39}, {"line": 7, "start": 2, "end": 17}, {"line": 8, "start": 0, "end": 6}, {"line": 9, "start": 2, "end": 48}, {"line": 10, "start": 2, "end": 55}], "group": [{"line": 4, "start": 7, "end": 29}, {"line": 6, "start": 7, "end": 29}], "iter": [{"line": 11, "start": 0, "end": 18}]}, "source": "SELECT continent, AVG(population) as population\nFROM\n  (SELECT *, \n    row_number() OVER \n      (PARTITION BY continent ORDER BY population) AS rank, \n    count() OVER \n      (PARTITION BY continent) as count\n  FROM countries)\nWHERE \n  (count % 2 = 1 AND rank = (count + 1) / 2) OR \n  (count % 2 = 0 AND ABS(rank - 0.5 - count / 2) = 0.5)\nGROUP BY continent", "author": "will", "implementation": ""}