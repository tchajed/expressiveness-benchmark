{"task": "continent_median_population", "language": "sql", "plan": {}, "source": "\nSELECT continent, AVG(population) as population\nFROM\n  (SELECT *, \n    row_number() OVER (PARTITION BY continent ORDER BY population) AS rank, \n    count() OVER (PARTITION BY continent) as count\n  FROM countries)\nWHERE \n  (count % 2 = 1 AND rank = (count + 1) / 2) OR \n  (count % 2 = 0 AND ABS(rank - 0.5 - count / 2) = 0.5)\nGROUP BY continent\n", "author": "will", "implementation": ""}