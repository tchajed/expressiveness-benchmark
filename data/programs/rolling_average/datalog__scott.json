{"task": "rolling_average", "language": "datalog", "plan": {}, "source": ".decl bucket(start_time: number, total: float, n: float)\nbucket(start_time, total, n) :- data(start_time, _),\n  total = sum v : {data(t, v), t >= start_time, t < start_time + 7},\n  n     = sum z : {data(t, v), t >= start_time, t < start_time + 7, z = 1.0}.\nrolling_average(start_time, v) :-\n  bucket(start_time, total, n), v = total / n.", "author": "scott", "implementation": ""}