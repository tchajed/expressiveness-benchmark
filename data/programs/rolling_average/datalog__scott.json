{"task": "rolling_average", "language": "datalog", "plan": {}, "source": ".decl bucket(end_time: number, total: float, n: float)\n.decl window(end_time: number, time: number)\nwindow(end_time, t) :- data(end_time, _), data(t, _), t <= end_time, t > end_time - 7.\nbucket(end_time, total, n) :- data(end_time, _),\n  total = sum v : {data(t, v), window(end_time, t)},\n  n     = sum z : {data(t, _), window(end_time, t), z = 1.0}.\nrolling_average(end_time, v) :-\n  bucket(end_time, total, n), v = total / n.", "author": "scott", "implementation": ""}