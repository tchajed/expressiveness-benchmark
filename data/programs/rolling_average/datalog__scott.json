{"task": "rolling_average", "language": "datalog", "plan": {"group": [{"line": 0, "start": 0, "end": 44}, {"line": 1, "start": 0, "end": 22}, {"line": 2, "start": 2, "end": 32}, {"line": 3, "start": 2, "end": 34}, {"line": 6, "start": 31, "end": 50}, {"line": 7, "start": 31, "end": 50}], "filter": [{"line": 9, "start": 30, "end": 43}, {"line": 9, "start": 19, "end": 27}, {"line": 6, "start": 2, "end": 15}, {"line": 7, "start": 6, "end": 15}], "windows": [{"line": 5, "start": 30, "end": 47}, {"line": 9, "start": 2, "end": 17}]}, "source": ".decl window(end_time: number, time: number)\nwindow(end_time, t) :-\n  data(end_time, _), data(t, _),\n  t <= end_time, t > end_time - 7.\n.decl bucket(end_time: number, total: float, n: float)\nbucket(end_time, total, n) :- data(end_time, _),\n  total = sum v : {data(t, v), window(end_time, t)},\n      n = sum z : {data(t, _), window(end_time, t), z = 1.0}.\nrolling_average(end_time, v) :-\n  bucket(end_time, total, n), v = total / n.", "author": "scott", "implementation": ""}