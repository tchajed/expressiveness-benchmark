{"task": "rolling_average", "language": "python-imperative", "plan": {}, "source": "def rolling_average(data):\n    data.sort(key=lambda v: v[\"time\"])\n    result = []\n    for i, value in enumerate(data):\n        end = value[\"time\"]\n        total, count = 0.0, 0\n        for j in range(i, -1, -1):\n            if data[j][\"time\"] <= end - 7:\n                break\n            total += data[j][\"x\"]; count += 1\n        result.append({\"end_time\": end, \"average\": total / count })\n    return result", "author": "scott", "implementation": ""}