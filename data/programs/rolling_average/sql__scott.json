{"task": "rolling_average", "language": "sql", "plan": {"windows": [{"line": 2, "start": 0, "end": 16}, {"line": 0, "start": 0, "end": 6}, {"line": 1, "start": 0, "end": 21}], "group": [{"line": 3, "start": 0, "end": 18}, {"line": 4, "start": 0, "end": 29}, {"line": 5, "start": 3, "end": 28}, {"line": 6, "start": 0, "end": 17}], "filter": [{"line": 1, "start": 23, "end": 46}]}, "source": "SELECT\nend.time as end_time,  AVG(other.x) as average\nFROM data as end\nJOIN data as other\nON other.time <= end.time and\n   other.time > end.time - 7\nGROUP BY end.time", "author": "scott", "implementation": ""}