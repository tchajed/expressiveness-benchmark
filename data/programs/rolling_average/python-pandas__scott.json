{"task": "rolling_average", "language": "python-pandas", "plan": {}, "source": "def rolling_average(data):\n    d = data.copy()\n    \n    data.time = pd.to_datetime(data.time * 10**9)\n    data = (data.sort_values('time').set_index('time')\n                .rolling(window='7s').mean())\n\n    return pd.DataFrame.from_dict({\n        'end_time': d.sort_values('time').reset_index().time,\n        'average': data.reset_index().x})", "author": "scott", "implementation": ""}