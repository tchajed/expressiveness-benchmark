{"task": "rolling_average", "language": "python-pandas", "plan": {"filter": [{"line": 5, "start": 36, "end": 42}, {"line": 9, "start": 5, "end": 37}], "group": [{"line": 5, "start": 15, "end": 35}, {"line": 3, "start": 2, "end": 47}], "windows": [{"line": 4, "start": 2, "end": 52}, {"line": 1, "start": 2, "end": 17}, {"line": 7, "start": 2, "end": 32}, {"line": 8, "start": 4, "end": 58}]}, "source": "def rolling_average(data):\n  d = data.copy()\n\n  data.time = pd.to_datetime(data.time * 10**9)\n  data = (data.sort_values('time').set_index('time')\n              .rolling(window='7s').mean())\n\n  return pd.DataFrame.from_dict(\n    {'end_time': d.sort_values('time').reset_index().time,\n     'average': data.reset_index().x}\n  )", "author": "scott", "implementation": ""}