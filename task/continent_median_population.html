<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Expressiveness Benchmark</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="3"/><link rel="preload" href="/expressiveness-benchmark/_next/static/css/0b9ba0c2982acd8038f7.css" as="style"/><link rel="stylesheet" href="/expressiveness-benchmark/_next/static/css/0b9ba0c2982acd8038f7.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/_app-faae9f5fca270bfaa6a4.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/48fe5443.bcb5bc3e601a586def78.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.d5e83ddfb8ec0326feec.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/task/%5Bid%5D-ebb6244aed139452441b.js" as="script"/></head><body><div id="__next"><div id="container"><div class="title"><h1><a href="/expressiveness-benchmark">Expressiveness Benchmark</a></h1><nav><a href="/expressiveness-benchmark">Task matrix</a><a href="/expressiveness-benchmark/analysis">Dataset analysis</a></nav></div><div class="pivot-view"><h2>Task<!-- -->: <!-- -->Median population for each continent</h2><div class="column-container"><div class="main-content"><div class="main-sticky"><div class="task-spec"><strong>Specification: </strong><span class="goal" style="background:rgba(161, 201, 244, 0.5);border:2px solid rgba(161, 201, 244, 1)">For each continent</span>,<!-- --> <!-- -->r<!-- -->e<!-- -->t<!-- -->u<!-- -->r<!-- -->n<!-- --> <span class="goal" style="background:rgba(255, 180, 130, 0.5);border:2px solid rgba(255, 180, 130, 1)">its name</span> <!-- -->a<!-- -->n<!-- -->d<!-- --> <!-- -->t<!-- -->h<!-- -->e<!-- --> <span class="goal" style="background:rgba(250, 176, 228, 0.5);border:2px solid rgba(250, 176, 228, 1)">median population</span> <span class="goal" style="background:rgba(141, 229, 161, 0.5);border:2px solid rgba(141, 229, 161, 1)">of its countries</span>.</div></div><div class="main-scroll"><div class="io"><strong>Example input/output:</strong><div class="data-container"><div><strong>Input:</strong> <code>countries</code><table><thead><tr><th>name</th><th>population</th><th>continent</th></tr></thead><tbody><tr><td><code>USA</code></td><td><code>328</code></td><td><code>North America</code></td></tr><tr><td><code>USA2</code></td><td><code>37</code></td><td><code>North America</code></td></tr><tr><td><code>Canada</code></td><td><code>37</code></td><td><code>North America</code></td></tr><tr><td><code>Ethiopia</code></td><td><code>109</code></td><td><code>Africa</code></td></tr></tbody></table></div><div><strong>Output:</strong> <code><table><thead><tr><th>continent</th><th>population</th></tr></thead><tbody><tr><td><code>North America</code></td><td><code>37</code></td></tr><tr><td><code>Africa</code></td><td><code>109</code></td></tr></tbody></table></code></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/python-imperative">Python - Imperative</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:437"></div></div><pre style="width:100%;height:437;line-height:1.3em">def continent_median_population(countries):
  populations = defaultdict(list)
  for country in countries:
    populations[country[&#x27;continent&#x27;]].append(country[&#x27;population&#x27;])
  
  output = []  
  for continent, pops in populations.items():
    pops.sort()
    N = len(pops)
    if N % 2 == 1:
      median = pops[(N - 1) // 2]
    else:
      median = (pops[N // 2 - 1] + pops[N // 2]) / 2
    output.append({
      &quot;continent&quot;: continent,
      &quot;population&quot;: median
    })
    
  return output</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/language/python-functional">Python - Functional</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:506"></div></div><pre style="width:100%;height:506;line-height:1.3em">def continent_median_population(countries):
  continents = set([c[&#x27;continent&#x27;] for c in countries])
  populations = {
    continent: [
      c[&#x27;population&#x27;] for c in countries 
      if c[&#x27;continent&#x27;] == continent
    ]
    for continent in continents
  }
  
  def compute_median(pops):
    pops = sorted(pops)
    N = len(pops)
    if N % 2 == 1:
      return pops[(N - 1) // 2]
    else:
      return (pops[N // 2 - 1] + pops[N // 2]) / 2  
   
  return [
    {&quot;continent&quot;: continent, &quot;population&quot;: compute_median(pops)}
    for continent, pops in populations.items()
  ]</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/python-pandas">Python - Pandas</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:115"></div></div><pre style="width:100%;height:115;line-height:1.3em">def continent_median_population(countries):
  return (countries
      .groupby(&#x27;continent&#x27;)
      .population.median()
      .reset_index())</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/language/r">R - Tidyverse</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:115"></div></div><pre style="width:100%;height:115;line-height:1.3em">continent_median_population &lt;- function(countries) {
  countries %&gt;%
    group_by(continent) %&gt;%
    summarize(population = median(population))
}</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/sql">SQL - SQLite</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:276"></div></div><pre style="width:100%;height:276;line-height:1.3em">SELECT continent, AVG(population) as population
FROM
  (SELECT *, 
    row_number() OVER 
      (PARTITION BY continent ORDER BY population) AS rank, 
    count() OVER 
      (PARTITION BY continent) as count
  FROM countries)
WHERE 
  (count % 2 = 1 AND rank = (count + 1) / 2) OR 
  (count % 2 = 0 AND ABS(rank - 0.5 - count / 2) = 0.5)
GROUP BY continent</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/language/datalog">Datalog - Souffle</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:644"></div></div><pre style="width:100%;height:644;line-height:1.3em">.decl unique_id(Country:symbol, Id:number)    
unique_id(Country, $) :- countries(_, Country, _).

.decl rank(Continent:symbol, R:number, Population:float)
rank(Continent, R_less + R_eq, Population) :-
  countries(Continent, Country, Population),
  unique_id(Country, Id),
  R_less = count : { 
    countries(Continent, C, P), 
    unique_id(C, Id2),
    P &lt; Population
  },
  R_eq = count : {
    countries(Continent, C, P), 
    unique_id(C, Id2),
    P = Population, 
    Id2 &lt; Id
  }.

continent_median_population(Continent, Median) :-
  countries(Continent, _, _),
  Num_countries = count : countries(Continent, _, _),
  ((Num_countries % 2 = 1, 
    rank(Continent, (Num_countries - 1) / 2, Median));
   (Num_countries % 2 = 0,
    rank(Continent, Num_countries / 2 - 1, P1),
    rank(Continent, Num_countries / 2, P2),
    Median = (P1 + P2) / 2)).     </pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/q">Q - kdb+</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:46"></div></div><pre style="width:100%;height:46;line-height:1.3em">continent_median_population:
  () xkey select med[population] by continent from countries</pre></div></div></div></div></div><div class="sidebar"><div class="sidebar-sticky"><div class="minimap"><button class="toggle">Toggle All</button><div><input type="checkbox" checked=""/>Python - Imperative</div><div><input type="checkbox" checked=""/>Python - Functional</div><div><input type="checkbox" checked=""/>Python - Pandas</div><div><input type="checkbox" checked=""/>R - Tidyverse</div><div><input type="checkbox" checked=""/>SQL - SQLite</div><div><input type="checkbox" checked=""/>Datalog - Souffle</div><div><input type="checkbox" checked=""/>Q - kdb+</div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"task":{"id":"continent_median_population","category":"Aggregation","name":"Median population for each continent","description":"For each continent, return its name and the median population of its countries.","plan":[{"id":"iter","description":"For each continent"},{"id":"name","description":"its name"},{"id":"group","description":"of its countries"},{"id":"agg","description":"median population"}],"sample_input":{"countries":[{"name":"USA","population":328,"continent":"North America"},{"name":"USA2","population":37,"continent":"North America"},{"name":"Canada","population":37,"continent":"North America"},{"name":"Ethiopia","population":109,"continent":"Africa"}]},"sample_output":[{"continent":"North America","population":37},{"continent":"Africa","population":109}]}},"__N_SSG":true},"page":"/task/[id]","query":{"id":"continent_median_population"},"buildId":"r9QSyWGv_-znMK8ucKmCr","assetPrefix":"/expressiveness-benchmark","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/expressiveness-benchmark/_next/static/chunks/polyfills-d2769c16f665abc9d1ae.js"></script><script src="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/_app-faae9f5fca270bfaa6a4.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/48fe5443.bcb5bc3e601a586def78.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.d5e83ddfb8ec0326feec.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/task/%5Bid%5D-ebb6244aed139452441b.js" async=""></script><script src="/expressiveness-benchmark/_next/static/r9QSyWGv_-znMK8ucKmCr/_buildManifest.js" async=""></script><script src="/expressiveness-benchmark/_next/static/r9QSyWGv_-znMK8ucKmCr/_ssgManifest.js" async=""></script></body></html>